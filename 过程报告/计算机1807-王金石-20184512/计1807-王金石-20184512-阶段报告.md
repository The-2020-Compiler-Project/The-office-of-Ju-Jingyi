计1807-王金石-20184512

由我负责的词法分析和语法分析程序分为两部分:词法分析(Scanner)和语法分析(Parser),分别将两个处理阶段封装成Scanner类和Parser 类，两个类分别完成词法分析和语法分析的任务。

Scanner类主要的工作是删除注释、词法分析获取Token。 Parser 类的主要工作是根据Scanner 类词法分析之后的Token 进行语法分析，生成语法树，最后并输出语法树。

词法分析和语法分析整体流程图如图所示https://sm.ms/image/B3fmZbMUVG6kD1d



词法分析阶段的代码被封装成一个类一一Scanner。

scanner.h 中主要是Scanner类的声明代码，scanner.cpp 中主要是Scanner 类的实现代码。Scanner类对外提供的函数主要有: getSourseStringFromFile(string s) (从文件中获取待分析的源代码). deleteComments() (过滤注释). scan() （词法分析主程序)。

词法分析的过程主要是:

1、Scanner调用getSourseStringFromFile(string s), 从文件中获取待分析的源代码

2、Scanner调用deleteComments()，将注释过滤掉，如果注释出错，则不进行词法分析

3、Scanner调用scan（),进行词法分析,将分析得到的所有Token保存在Scanner类的成员变量tokenList 中，以备语法阶段调用，并将Token 输出到文件Token.txt中。



语法分析的过程主要是:

在语法分析之前进行词法分析，然后通过递归向下分析法根据C语言的文法进行语法分析，并生成语法树，最后打印语法树，输出到文件tokenTree. txt中。具体实现代码还在编写中。





文法（总）：

<程序> → <主函数> | <主函数> <声明>

<主函数> → <类型标识符> <声明>|<类型标识符> <声明> <复合语句>

<声明> → <定义>|<定义><声明>

<定义> → <类型标识符> <数据声明;>|<类型标识符> <函数声明> <复合语句>|<类型标识符> <函数声明;> 

<标识符类型> → <void> | <char> | <int> | <float>

<数据声明> → <标识符> | <数据声明[ ]> | <数据声明[常量表达式]> | <数据声明 , 标识符>|<数据声明=初始化程序>

<函数声明> → <标识符（参数列表）> | <标识符（）> 

<常量表达式> → <条件表达式>

<参数列表> → <参数声明> | <参数列表 ,参数声明>

<参数声明> → <说明符声明><标识符>

<复合语句> → <{ }> | <{ 语句列表 }> | <{ <声明列表> <语句列表> }>

<声明列表> → <定义> | <定义><声明列表>

<初始化程序> → <表达式> 

<语句列表> → <语句> | <语句列表> <语句>

<语句> → <复合语句> | <表达式语句> | <选择语句> |<跳转语句>

<表达式语句> → <表达式;>

<选择语句> → < IF（表达式）语句> | < IF（表达式）语句 > < ELSE 语句>

<跳转语句> → <continue;> |<breack;> | <return;> | <return 表达式; >

<表达式> → <赋值表达式> | <表达式, 赋值表达式>

<赋值表达式> → <条件表达式> | <一元表达式> <赋值操作符> <赋值表达式>

<条件表达式> → <逻辑‘或’表达式> | <逻辑‘或’表达式？> <表达式:> <条件表达式>

<逻辑‘或’表达式> → <逻辑‘与’表达式> | <逻辑‘或’表达式> <‘或’运算> <逻辑‘与’表达式>

<逻辑‘与’表达式> → <逻辑‘或’表达式> | <逻辑‘与’表达式> <‘与’运算> <逻辑‘或’表达式>

<或运算表达式> → <异或表达式> | <或运算表达式‘|’ 异或表达式>

<异或表达式> → <与表达式> | <异或表达式 ^ 与表达式>

<与表达式> → <相等表达式> | <与表达式 & 相等表达式>

<相等表达式>→ <关系表达式> | <相等表达式> <等于运算> <关系表达式> | <相等表达式> <不等于运算> <关系表达式>

<关系表达式> → <替换表达式> | <关系表达式 < 替换表达式> | <关系表达式 > 替换表达式> | <关系表达式<=替换表达式> | <关系表达式>=替换表达式>

<替换表达式> → <加法表达式> | <替换表达式> <左运算> <加法表达式> | <替换表达式> <右运算> <加法表达式>

<加法表达式> → <乘法表达式> | <加法表达式 + 乘法表达式> | <加法表达式 - 乘法表达式>

<乘法表达式> → <强制转换表达式> | <乘法表达式 * 强制转换表达式> | <乘法表达式 / 强制转换表达式> | <乘法表达式 % 强制转换表达式>

<强制转换表达式> → <一元表达式> | <（类型名称）强制转换表达式>

<一元表达式> → <后缀表达式> | <加一运算> <一元表达式> | <减一运算> <一元表达式> | <一元运算符> <强制转换表达式> | <结构体变量> <一元表达式> | <结构体变量（类型名称）>

<后缀表达式> → <基本表达式> | <后缀表达式 [ 表达式 ]> | <后缀表达式（）> | <后缀表达式（参数表达式列表）> | <后缀表达式> <指针运算> <标识符> | <后缀表达式> <加一运算> | <后缀表达式> <减一运算>

<基本表达式> → <标识符> | <常量> | <字符串> | <（表达式）>

<参数表达式列表> → <参数表达式> | <参数表达式列表 , 参数表达式>

<一元运算符> → <&> | <*> | <+> |<-> | <~> | <!>

< 赋值运算符> → <=> | <乘法赋值> | <除法赋值> | <求余赋值> | <加法赋值> | <减法赋值> | <左赋值> | <右赋值> | <与赋值> | <异或赋值> | <或赋值>

 

精简后的文法:

<程序> → <主函数>

<主函数> → <类型标识符> <声明>|<类型标识符> <声明> <复合语句>

<声明> → <定义>|<定义><声明>

<定义> → <类型标识符> <数据声明;>|<类型标识符> <函数声明> <复合语句>|<类型标识符> <函数声明;> 

<标识符类型> → <void> | <char> | <int> | <float>

<数据声明> → <标识符> | <数据声明[ ]> | <数据声明[常量表达式]> | <数据声明 , 标识符>|<数据声明=初始化程序>

<函数声明> → <标识符（参数列表）> | <标识符（）> 

<常量表达式> → <条件表达式>

<参数列表> → <参数声明> | <参数列表 ,参数声明>

<参数声明> → <标志符类型><标识符>

<复合语句> → <{ }> | <{ 语句列表 }> | <{ <声明列表> <语句列表> }>

<初始化程序> → <表达式> 

<语句列表> → <语句> | <语句列表> <语句>

<语句> → <复合语句> |

<表达式> → <赋值表达式> 

<赋值表达式> → <一元表达式> <=> <加法表达式>

<加法表达式> → <乘法表达式> | <加法表达式 + 乘法表达式> | <加法表达式 - 乘法表达式>

<乘法表达式> → <一元表达式> | <乘法表达式 * 一元表达式> | <乘法表达式 / 一元表达式> | <乘法表达式 % 一元表达式>

<一元表达式> → <后缀表达式> 

<后缀表达式> → <基本表达式> | <后缀表达式 [ 表达式 ]> | <后缀表达式（）> | <后缀表达式（参数表达式列表）> 

<基本表达式> → <标识符> | <常量> | <字符串> | <（表达式）>

<参数表达式列表> → <参数表达式> | <参数表达式列表 , 参数表达式>

<参数表达式> → <加法表达式>